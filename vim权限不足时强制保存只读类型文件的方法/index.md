# Vim权限不足时强制保存只读类型文件的方法


在使用`vim`时，当我们以普通用户去打开一个只有`root`用户才有权限操作的文件时，我们编辑完成之后，正要保存，却发现，这个文件我们没有权限修改。
经过查找，发现一个命令可以解决这个问题
命令：
<!--more-->
`:w !sudo tee %`

>w： 表示保存文件
>！： 表示执行外部命令
>tee： linux命令，这个有点复杂，可以查看linux命令帮助
>%： 在执行外部命令时，%会扩展成当前文件名；这个%区别于替换时的%，替换时%的意义是代表整个文件，而不是文件名

此命令是把当前文件（即`%`）作为`stdin`传给`sudo tee`命令来执行。说起来挺绕口，其实就是：用`sudo`强制保存。
这行命令解决了不能保存只读文件的问题，但毕竟命令还是有些长，为了避免每次输入一长串的命令，可以将它映射为一个简单的命令加到 `.vimrc` 中：
```shell
" Allow saving of files as sudo when I forgot to start vim using sudo.
cmap w!! w !sudo tee > /dev/null %
```
这样，简单的运行`:w!!`即可。命令后半部分`> /dev/null`作用为显式的丢掉标准输出的内容。
